<UserControl x:Class="TwainControl.TwainCtrl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:ComponentModel="clr-namespace:System.ComponentModel;assembly=WindowsBase"
    xmlns:Controls="clr-namespace:Extensions.Controls;assembly=Extensions"
    xmlns:Converter="clr-namespace:TwainControl.Converter"
    xmlns:Extensions="clr-namespace:Extensions;assembly=Extensions"
    xmlns:PdfViewer="clr-namespace:PdfViewer;assembly=PdfViewer"
    xmlns:System="clr-namespace:System;assembly=mscorlib"
    xmlns:TwainNative="clr-namespace:TwainWpf.TwainNative;assembly=TwainWpf"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:ice="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
    xmlns:local="clr-namespace:TwainControl"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:properties="clr-namespace:TwainControl.Properties"
    x:Name="UserControl"
    d:DataContext="{d:DesignInstance Type={x:Type local:TwainCtrl}}"
    d:DesignHeight="800" d:DesignWidth="1024"
    local:Translation.ResourceManager="{x:Static properties:Resources.ResourceManager}"
    Loaded="UserControl_Loaded" UseLayoutRounding="True"
    mc:Ignorable="d">
    <UserControl.InputBindings>
        <KeyBinding Key="F1" Command="{Binding OpenHelpDialog}" />
    </UserControl.InputBindings>
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/TwainControl;component/Slider.xaml" />
                <ResourceDictionary Source="/Extensions;component/Themes/Skin.xaml" />
                <ResourceDictionary Source="/TwainControl;component/CommonResource.xaml" />
            </ResourceDictionary.MergedDictionaries>
            <PdfViewer:PageNumberOneUpConverter x:Key="PageNumberOneUpConverter" />
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <Converter:SplitConverter x:Key="SplitConverter" />
            <Converter:EnumPageRotationToConvertedLanguageTextConverter x:Key="EnumPageRotationToConvertedLanguageTextConverter" />
            <Converter:EnumOrientationToConvertedLanguageTextConverter x:Key="EnumOrientationToConvertedLanguageTextConverter" />
            <Converter:EnumOrientationToTwainVersionConverter x:Key="EnumOrientationToTwainVersionConverter" />
            <Extensions:NullableToBooleanConverter x:Key="NullableToBooleanConverter" />
            <Extensions:FilePathToIconConverter x:Key="FilePathToIconConverter" />
            <Extensions:SystemFileIconConverter x:Key="SystemFileIconConverter" />
            <DrawingBrush x:Key="Dur" ice:Freeze="True" Stretch="Uniform">
                <DrawingBrush.Drawing>
                    <DrawingGroup>
                        <GeometryDrawing ice:Freeze="True" Brush="Black" Geometry="F1 M 5.27184,18L 0,12.7282L 0,5.27184L 5.27184,1.90735e-006L 12.7282,1.90735e-006L 18,5.27184L 18,12.7282L 12.7282,18L 5.27184,18 Z " />
                        <GeometryDrawing ice:Freeze="True" Brush="White" Geometry="F1 M 5.38416,17.7293L 0.26928,12.6158L 0.26928,5.38416L 5.38416,0.269283L 12.6158,0.270723L 17.7293,5.38416L 17.7293,12.6158L 12.6158,17.7293L 5.38416,17.7293 Z " />
                        <GeometryDrawing ice:Freeze="True" Brush="Red" Geometry="F1 M 0.684,12.4445L 0.684,5.55552L 5.55552,0.684002L 12.4445,0.684002L 17.316,5.55552L 17.316,12.4445L 12.4445,17.316L 5.55552,17.316L 0.684,12.4445 Z " />
                    </DrawingGroup>
                </DrawingBrush.Drawing>
            </DrawingBrush>
            <ControlTemplate x:Key="ValidationErrorTemplate">
                <Grid Focusable="False">
                    <Canvas x:Name="Cnv"
                        Width="18" Height="18"
                        HorizontalAlignment="Center" VerticalAlignment="Center"
                        Background="{StaticResource Dur}"
                        DataContext="{Binding ElementName=Adorner, Mode=OneWay}"
                        RenderTransformOrigin="0.5,0.5" UseLayoutRounding="True">
                        <Canvas.ToolTip>
                            <ToolTip Background="{x:Null}" BorderBrush="{x:Null}" Foreground="{x:Null}">
                                <Border Padding="4"
                                    Background="Red" BorderBrush="White"
                                    BorderThickness="1">
                                    <TextBlock Foreground="White" Text="{Binding AdornedElement.(Validation.Errors)/ErrorContent, Mode=OneWay}" />
                                </Border>
                            </ToolTip>
                        </Canvas.ToolTip>
                        <Viewbox Width="18" Height="18">
                            <TextBlock Foreground="White" Text="{local:Loc STOP}" />
                        </Viewbox>
                    </Canvas>
                    <AdornedElementPlaceholder x:Name="Adorner" />
                </Grid>
            </ControlTemplate>
            <Style x:Key="ToggleButtonAnimationStyle" TargetType="{x:Type ToggleButton}">
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Animate}" Value="true">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard x:Name="Sb">
                                <Storyboard Timeline.DesiredFrameRate="12">
                                    <DoubleAnimationUsingKeyFrames RepeatBehavior="1" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)">
                                        <EasingDoubleKeyFrame KeyTime="0" Value="0" />
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.3" Value="5" />
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.6" Value="-5" />
                                        <EasingDoubleKeyFrame KeyTime="0:0:0.9" Value="0" />
                                    </DoubleAnimationUsingKeyFrames>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Animate}" Value="false">
                        <DataTrigger.EnterActions>
                            <RemoveStoryboard BeginStoryboardName="Sb" />
                        </DataTrigger.EnterActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
            <Style x:Key="ScanTypeLbItem" TargetType="{x:Type ListBoxItem}">
                <Setter Property="Margin" Value="1" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Border Padding="{TemplateBinding Padding}"
                                Background="{TemplateBinding Panel.Background}"
                                BorderBrush="{TemplateBinding Border.BorderBrush}"
                                BorderThickness="{TemplateBinding Border.BorderThickness}"
                                SnapsToDevicePixels="True">
                                <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                    VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                    Content="{TemplateBinding ContentControl.Content}"
                                    ContentStringFormat="{TemplateBinding ContentControl.ContentStringFormat}"
                                    ContentTemplate="{TemplateBinding ContentControl.ContentTemplate}"
                                    SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Style.Triggers>
                    <Trigger Property="IsSelected" Value="True">
                        <Setter Property="Background" Value="{StaticResource BorderBackground}" />
                        <Setter Property="BorderBrush" Value="{StaticResource GroupBoxBackGround}" />
                    </Trigger>
                </Style.Triggers>
            </Style>
            <Style TargetType="{x:Type GroupBox}">
                <Setter Property="Background" Value="{StaticResource GroupBoxBackGround}" />
                <Setter Property="BorderBrush" Value="Black" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type GroupBox}">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>
                                <Border Grid.Row="0"
                                    Background="{TemplateBinding Background}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1" CornerRadius="3,3,0,0">
                                    <ContentPresenter Margin="4" ContentSource="Header" RecognizesAccessKey="True" />
                                </Border>
                                <Border Grid.Row="1"
                                    Background="{StaticResource BorderBackground}"
                                    BorderBrush="{TemplateBinding BorderBrush}"
                                    BorderThickness="1,0,1,1" CornerRadius="0,0,1,1">
                                    <ContentPresenter Margin="1" />
                                </Border>
                            </Grid>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <ObjectDataProvider x:Key="PageOrientation" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="TwainNative:Orientation" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
            <ObjectDataProvider x:Key="PageRotations" MethodName="GetValues" ObjectType="{x:Type System:Enum}">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="local:PageRotation" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>
            <CollectionViewSource x:Key="CompProfiles" Source="{Binding CompressionProfiles}">
                <CollectionViewSource.GroupDescriptions>
                    <PropertyGroupDescription PropertyName="Item1" />
                </CollectionViewSource.GroupDescriptions>
            </CollectionViewSource>
            <CollectionViewSource x:Key="PaperProfiles" Source="{Binding Papers}">
                <CollectionViewSource.GroupDescriptions>
                    <PropertyGroupDescription PropertyName="Category" />
                </CollectionViewSource.GroupDescriptions>
                <CollectionViewSource.SortDescriptions>
                    <ComponentModel:SortDescription PropertyName="Height" />
                </CollectionViewSource.SortDescriptions>
            </CollectionViewSource>
            <CollectionViewSource x:Key="FolderDates" Source="{Binding Scanner.FolderDateFormats}">
                <CollectionViewSource.GroupDescriptions>
                    <PropertyGroupDescription PropertyName="Value" />
                </CollectionViewSource.GroupDescriptions>
            </CollectionViewSource>
            <Style TargetType="{x:Type Button}">
                <Setter Property="Background" Value="{StaticResource BorderBackground}" />
                <Setter Property="local:Policy.PolicyEnabled" Value="True" />
            </Style>
            <Style TargetType="{x:Type RepeatButton}">
                <Setter Property="Background" Value="{StaticResource BorderBackground}" />
                <Setter Property="local:Policy.PolicyEnabled" Value="True" />
            </Style>
            <Style TargetType="{x:Type ListBox}">
                <Setter Property="local:Policy.PolicyEnabled" Value="True" />
            </Style>
            <Style TargetType="{x:Type ComboBox}">
                <Setter Property="Template" Value="{StaticResource ComboBoxStyle}" />
                <Setter Property="local:Policy.PolicyEnabled" Value="True" />
            </Style>
            <Style TargetType="{x:Type Hyperlink}">
                <Setter Property="local:Policy.PolicyEnabled" Value="True" />
            </Style>
            <Style TargetType="{x:Type Extensions:ContentToggleButton}">
                <Setter Property="Background" Value="{StaticResource BorderBackground}" />
            </Style>
            <Style TargetType="{x:Type Extensions:SplitButton}">
                <Setter Property="Background" Value="{StaticResource BorderBackground}" />
            </Style>
            <Style TargetType="{x:Type ToggleButton}">
                <Setter Property="Background" Value="{StaticResource BorderBackground}" />
            </Style>
            <Style x:Key="BorderGroupStyleContainerStyle" TargetType="{x:Type GroupItem}">
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate>
                            <Border BorderBrush="Black" BorderThickness="0.5">
                                <ItemsPresenter />
                            </Border>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{Binding TwainGuiControlLength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" d:Width="5*" />
            <ColumnDefinition Width="3" />
            <ColumnDefinition Width="{Binding DocumentGridLength, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" d:Width="5*" />
        </Grid.ColumnDefinitions>
        <GroupBox Grid.Column="0">
            <GroupBox.Header>
                <UniformGrid Columns="2">
                    <TextBlock Text="{local:Loc SRC}" />
                    <Extensions:ContentToggleButton HorizontalAlignment="Right"
                        Background="{x:Null}"
                        BorderBrush="{x:Null}"
                        IsChecked="{Binding HelpIsOpened}">
                        <Image Width="16" Height="16">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                    <Binding Source="Shell32.dll" />
                                    <Binding Source="23" />
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <Extensions:ContentToggleButton.OverContent>
                            <GroupBox Width="450" Height="400" Header="{local:Loc HELP}">
                                <FlowDocumentScrollViewer IsSelectionEnabled="False" VerticalScrollBarVisibility="Auto">
                                    <FlowDocument IsOptimalParagraphEnabled="True">
                                        <Paragraph>
                                            <Rectangle Width="120" Height="35" Stroke="Cyan" />
                                            <Run Text="{local:Loc CYANCONTROL}" />
                                            <LineBreak />
                                            <Rectangle Width="120" Height="35">
                                                <Rectangle.Fill>
                                                    <VisualBrush Stretch="Fill" Visual="{Binding Source={x:Reference CbFolderFormat}}" />
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Run Text="{local:Loc FOLDERFORMAT}" />
                                            <LineBreak />
                                            <Rectangle Width="120" Height="35">
                                                <Rectangle.Fill>
                                                    <VisualBrush Stretch="Fill" Visual="{Binding Source={x:Reference AutoScanPathBtn}}" />
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Run Text="{local:Loc AUTOFOLDERHELP}" />
                                            <LineBreak />
                                            <Rectangle Width="120" Height="35">
                                                <Rectangle.Fill>
                                                    <VisualBrush Stretch="Fill" Visual="{Binding Source={x:Reference SpDelay}}" />
                                                </Rectangle.Fill>
                                            </Rectangle>
                                            <Run Text="{local:Loc SCANDELAYHELP}" />
                                            <LineBreak />
                                            <TextBlock TextWrapping="Wrap">
                                                <Run Foreground="Red" Text="{local:Loc KNOWNPROBLEMS}" />
                                                <LineBreak />
                                                <Run Text="{local:Loc ERROR1}" />
                                            </TextBlock>
                                        </Paragraph>
                                    </FlowDocument>
                                </FlowDocumentScrollViewer>
                            </GroupBox>
                        </Extensions:ContentToggleButton.OverContent>
                    </Extensions:ContentToggleButton>
                </UniformGrid>
            </GroupBox.Header>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition />
                    <RowDefinition Height="70.4" />
                </Grid.RowDefinitions>
                <Expander Grid.Row="0"
                    Background="{StaticResource GroupBoxBackGround}"
                    BorderBrush="Black"
                    IsExpanded="{Binding ScanSettingsExpanderIsExpanded, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, Source={x:Static properties:Settings.Default}}">
                    <Expander.Header>
                        <Border BorderBrush="GreenYellow" BorderThickness="2">
                            <Grid HorizontalAlignment="{Binding HorizontalAlignment, Mode=OneWayToSource, RelativeSource={RelativeSource AncestorType={x:Type ContentPresenter}}}">
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition />
                                    <ColumnDefinition Width="Auto" />
                                </Grid.ColumnDefinitions>
                                <ComboBox local:Policy.PolicyName="SeçiliTarayıcı"
                                    IsEnabled="{Binding Scanner.ArayüzEtkin}"
                                    ItemsSource="{Binding Scanner.Tarayıcılar}"
                                    SelectedItem="{Binding SeçiliTarayıcı, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Width="24" Height="24">
                                                    <Image.Source>
                                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                            <Binding Source="Shell32.dll" />
                                                            <Binding Source="201" />
                                                        </MultiBinding>
                                                    </Image.Source>
                                                </Image>
                                                <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{Binding Mode=OneWay}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <StackPanel x:Name="SpDelay" Grid.Column="1" Orientation="Horizontal">
                                    <Image Width="16" Height="16">
                                        <Image.Source>
                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                <Binding Source="Shell32.dll" />
                                                <Binding Source="20" />
                                            </MultiBinding>
                                        </Image.Source>
                                    </Image>
                                    <Extensions:NumericUpDownControl IsReadOnly="True" Maximum="120"
                                        Minimum="0" SmallChange="1"
                                        Value="{Binding ScanDelay, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}" />
                                    <Image Width="16" Height="16">
                                        <Image.Source>
                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                <Binding Source="Shell32.dll" />
                                                <Binding Source="54" />
                                            </MultiBinding>
                                        </Image.Source>
                                    </Image>
                                    <Extensions:NumericUpDownControl IsReadOnly="True" Maximum="120"
                                        Minimum="0" SmallChange="1"
                                        Value="{Binding ScanBetweenDelay, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}" />
                                    <TextBlock VerticalAlignment="Center" Text="{local:Loc SECOND}" />
                                </StackPanel>
                                <UniformGrid Grid.Row="1" Grid.ColumnSpan="2" Columns="4">
                                    <Extensions:ContentToggleButton StaysOpen="True" TopMost="False">
                                        <Extensions:ContentToggleButton.OverContent>
                                            <Extensions:ResizablePanel Width="680" Height="480"
                                                MinWidth="480" MinHeight="360">
                                                <local:CameraUserControl x:Name="Camera" />
                                            </Extensions:ResizablePanel>
                                        </Extensions:ContentToggleButton.OverContent>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Width="32" Height="32">
                                                <Image.Source>
                                                    <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                        <Binding Source="Shell32.dll" />
                                                        <Binding Source="203" />
                                                    </MultiBinding>
                                                </Image.Source>
                                            </Image>
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc CAMERA}" />
                                        </StackPanel>
                                    </Extensions:ContentToggleButton>
                                    <Button local:Policy.PolicyName="ScanImage" Command="{Binding ScanImage}" IsEnabled="{Binding Scanner.ArayüzEtkin}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Width="32" Height="32">
                                                <Image.Source>
                                                    <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                        <Binding Source="Shell32.dll" />
                                                        <Binding Source="201" />
                                                    </MultiBinding>
                                                </Image.Source>
                                            </Image>
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc SCAN}" />
                                        </StackPanel>
                                    </Button>
                                    <Button local:Policy.PolicyName="FastScanImage"
                                        Command="{Binding FastScanImage}"
                                        IsDefault="True"
                                        IsEnabled="{Binding Scanner.ArayüzEtkin}">
                                        <StackPanel Orientation="Horizontal">
                                            <Canvas Width="32" Height="32">
                                                <Image Width="32" Height="32">
                                                    <Image.Source>
                                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                            <Binding Source="Shell32.dll" />
                                                            <Binding Source="201" />
                                                        </MultiBinding>
                                                    </Image.Source>
                                                </Image>
                                                <Image Canvas.Left="0" Canvas.Bottom="0"
                                                    Width="20" Height="20"
                                                    Source="/TwainControl;component/Icons/save.png" />
                                            </Canvas>
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc FASTSCAN}" />
                                        </StackPanel>
                                    </Button>
                                    <Button x:Name="AutoScanPathBtn" local:Policy.PolicyName="KayıtYoluBelirle" Command="{Binding KayıtYoluBelirle}">
                                        <StackPanel Orientation="Horizontal">
                                            <Canvas Width="32" Height="32">
                                                <Image Width="32" Height="32">
                                                    <Image.Source>
                                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                            <Binding Source="Shell32.dll" />
                                                            <Binding Source="4" />
                                                        </MultiBinding>
                                                    </Image.Source>
                                                </Image>
                                                <Image Canvas.Left="0" Canvas.Bottom="0"
                                                    Width="20" Height="20"
                                                    Source="/TwainControl;component/Icons/save.png" />
                                            </Canvas>
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc AUTOPATH}" />
                                        </StackPanel>
                                    </Button>
                                </UniformGrid>
                            </Grid>
                        </Border>
                    </Expander.Header>
                    <GroupBox IsEnabled="{Binding Scanner.ArayüzEtkin}">
                        <GroupBox.Header>
                            <UniformGrid Margin="1" Columns="4">
                                <ComboBox x:Name="CbFolderFormat"
                                    local:Policy.PolicyName="FolderDateFormat"
                                    ItemsSource="{Binding Source={StaticResource FolderDates}}"
                                    SelectedValue="{Binding FolderDateFormat, Source={x:Static properties:Settings.Default}}"
                                    SelectedValuePath="Key">
                                    <ComboBox.GroupStyle>
                                        <GroupStyle ContainerStyle="{StaticResource BorderGroupStyleContainerStyle}">
                                            <GroupStyle.Panel>
                                                <ItemsPanelTemplate>
                                                    <UniformGrid Columns="4" />
                                                </ItemsPanelTemplate>
                                            </GroupStyle.Panel>
                                            <GroupStyle.HeaderTemplate>
                                                <DataTemplate />
                                            </GroupStyle.HeaderTemplate>
                                        </GroupStyle>
                                    </ComboBox.GroupStyle>
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock VerticalAlignment="Center" Text="{Binding Mode=OneWay, Path=Key}" />
                                                <Button VerticalAlignment="Center"
                                                    Background="{x:Null}"
                                                    BorderBrush="{x:Null}"
                                                    Command="{Binding ShowDateFolderHelp, RelativeSource={RelativeSource AncestorType={x:Type local:TwainCtrl}}}">
                                                    <Image Width="16" Height="16">
                                                        <Image.Source>
                                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                                <Binding Source="Shell32.dll" />
                                                                <Binding Source="23" />
                                                            </MultiBinding>
                                                        </Image.Source>
                                                    </Image>
                                                </Button>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                                <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center"
                                    d:Text="AutoFolder" FontWeight="Bold">
                                    <Hyperlink local:Policy.PolicyName="WebAdreseGit" Command="{Binding WebAdreseGit}" CommandParameter="{Binding AutoFolder, Mode=OneWay, Source={x:Static properties:Settings.Default}}">
                                        <Run Text="{Binding Scanner.LocalizedPath, Mode=OneWay}" />
                                    </Hyperlink>
                                </TextBlock>
                                <Grid VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Margin="0,0,2,0" VerticalAlignment="Center" Text="DPI" />
                                    <Slider Grid.Column="1"
                                        AutoToolTipPlacement="TopLeft" BorderBrush="GreenYellow"
                                        BorderThickness="2" IsSnapToTickEnabled="True"
                                        Maximum="4800" Minimum="72"
                                        SmallChange="1"
                                        Style="{StaticResource Slider}"
                                        Ticks="72,96,120,150,200,300,450,600,1200,2400,4800"
                                        ToolTip="{local:Loc RES}"
                                        Value="{Binding Çözünürlük, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}" />
                                </Grid>
                                <ComboBox VerticalContentAlignment="Center"
                                    local:Policy.PolicyName="SelectedRotation"
                                    IsEnabled="{Binding Scanner.ArayüzEtkin}"
                                    ItemsSource="{Binding Mode=OneWay, Source={StaticResource PageRotations}}"
                                    SelectedItem="{Binding SelectedRotation}">
                                    <ComboBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Converter={StaticResource EnumPageRotationToConvertedLanguageTextConverter}, Mode=OneWay}" />
                                        </DataTemplate>
                                    </ComboBox.ItemTemplate>
                                </ComboBox>
                            </UniformGrid>
                        </GroupBox.Header>
                        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                            <StackPanel VerticalAlignment="Top">
                                <StackPanel.Resources>
                                    <Style BasedOn="{StaticResource {x:Type CheckBox}}" TargetType="{x:Type CheckBox}">
                                        <Setter Property="VerticalAlignment" Value="Center" />
                                        <Setter Property="VerticalContentAlignment" Value="Center" />
                                    </Style>
                                </StackPanel.Resources>
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal">
                                        <ToggleButton BorderBrush="GreenYellow" BorderThickness="2" IsChecked="{Binding Adf, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                            <ToggleButton.Style>
                                                <Style BasedOn="{StaticResource {x:Type ToggleButton}}" TargetType="{x:Type ToggleButton}">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsChecked" Value="True">
                                                            <Setter Property="Content">
                                                                <Setter.Value>
                                                                    <Grid>
                                                                        <Image Width="68" Height="32"
                                                                            Source="/TwainControl;component/Icons/adf.png"
                                                                            Visibility="{Binding Adf, Converter={StaticResource BooleanToVisibilityConverter}, Mode=OneWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}" />
                                                                        <TextBlock VerticalAlignment="Center"
                                                                            FontWeight="Bold" Foreground="White"
                                                                            Text="{local:Loc ADF}" />
                                                                    </Grid>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                        <Trigger Property="IsChecked" Value="False">
                                                            <Setter Property="Content">
                                                                <Setter.Value>
                                                                    <Grid>
                                                                        <Image Width="68" Height="32" Source="/TwainControl;component/Icons/flatbed.png" />
                                                                        <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc FLATBED}" />
                                                                    </Grid>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </ToggleButton.Style>
                                        </ToggleButton>
                                        <ListBox local:Policy.PolicyName="Mode"
                                            Background="{x:Null}"
                                            BorderBrush="GreenYellow" BorderThickness="2"
                                            SelectedIndex="{Binding Mode, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                            <ListBox.ItemContainerStyle>
                                                <Style BasedOn="{StaticResource ScanTypeLbItem}" TargetType="{x:Type ListBoxItem}" />
                                            </ListBox.ItemContainerStyle>
                                            <ListBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel Orientation="Horizontal" />
                                                </ItemsPanelTemplate>
                                            </ListBox.ItemsPanel>
                                            <ListBoxItem HorizontalAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center">
                                                <Grid x:Name="bw">
                                                    <Image Width="32" Height="32">
                                                        <Image.Effect>
                                                            <Extensions:BlackWhiteEffect Threshold="0.95" />
                                                        </Image.Effect>
                                                        <Image.Source>
                                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                                <Binding Source="Shell32.dll" />
                                                                <Binding Source="1" />
                                                            </MultiBinding>
                                                        </Image.Source>
                                                    </Image>
                                                    <TextBlock VerticalAlignment="Center"
                                                        FontWeight="Bold" RenderTransformOrigin="0.5,0.5"
                                                        Text="{local:Loc BW}">
                                                        <TextBlock.LayoutTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <SkewTransform />
                                                                <RotateTransform Angle="-15" />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </TextBlock.LayoutTransform>
                                                    </TextBlock>
                                                </Grid>
                                            </ListBoxItem>
                                            <ListBoxItem HorizontalAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center">
                                                <Grid x:Name="grey">
                                                    <Image Width="32" Height="32">
                                                        <Image.Effect>
                                                            <Extensions:GrayScaleEffect />
                                                        </Image.Effect>
                                                        <Image.Source>
                                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                                <Binding Source="Shell32.dll" />
                                                                <Binding Source="1" />
                                                            </MultiBinding>
                                                        </Image.Source>
                                                    </Image>
                                                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center"
                                                        FontWeight="Bold" Foreground="Gray"
                                                        Text="{local:Loc GRAY}">
                                                        <TextBlock.LayoutTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <SkewTransform />
                                                                <RotateTransform Angle="-15" />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </TextBlock.LayoutTransform>
                                                    </TextBlock>
                                                </Grid>
                                            </ListBoxItem>
                                            <ListBoxItem HorizontalAlignment="Center" VerticalAlignment="Center" VerticalContentAlignment="Center">
                                                <Grid x:Name="color">
                                                    <Image Width="32" Height="32">
                                                        <Image.Source>
                                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                                <Binding Source="Shell32.dll" />
                                                                <Binding Source="1" />
                                                            </MultiBinding>
                                                        </Image.Source>
                                                    </Image>
                                                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Center"
                                                        FontWeight="Bold"
                                                        Foreground="{StaticResource Colorfull}"
                                                        Text="{local:Loc COLOR}">
                                                        <TextBlock.LayoutTransform>
                                                            <TransformGroup>
                                                                <ScaleTransform />
                                                                <SkewTransform />
                                                                <RotateTransform Angle="-15" />
                                                                <TranslateTransform />
                                                            </TransformGroup>
                                                        </TextBlock.LayoutTransform>
                                                    </TextBlock>
                                                </Grid>
                                            </ListBoxItem>
                                        </ListBox>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="80" />
                                                <ColumnDefinition Width="70" />
                                            </Grid.ColumnDefinitions>
                                            <Extensions:ContentToggleButton BorderBrush="GreenYellow" BorderThickness="2">
                                                <Extensions:ContentToggleButton.OverContent>
                                                    <StackPanel>
                                                        <ListBox HorizontalContentAlignment="Stretch" VerticalContentAlignment="Center"
                                                            ItemsSource="{Binding Mode=OneWay, Source={StaticResource CompProfiles}}"
                                                            SelectedItem="{Binding SelectedCompressionProfile}">
                                                            <ListBox.ItemContainerStyle>
                                                                <Style TargetType="{x:Type ListBoxItem}">
                                                                    <Style.Triggers>
                                                                        <Trigger Property="IsSelected" Value="True">
                                                                            <Setter Property="Foreground" Value="Blue" />
                                                                        </Trigger>
                                                                    </Style.Triggers>
                                                                </Style>
                                                            </ListBox.ItemContainerStyle>
                                                            <ListBox.ItemsPanel>
                                                                <ItemsPanelTemplate>
                                                                    <UniformGrid Columns="2" />
                                                                </ItemsPanelTemplate>
                                                            </ListBox.ItemsPanel>
                                                            <ListBox.GroupStyle>
                                                                <GroupStyle>
                                                                    <GroupStyle.Panel>
                                                                        <ItemsPanelTemplate>
                                                                            <UniformGrid Background="{StaticResource GroupBoxBackGround}" Columns="2" />
                                                                        </ItemsPanelTemplate>
                                                                    </GroupStyle.Panel>
                                                                    <GroupStyle.HeaderTemplate>
                                                                        <DataTemplate>
                                                                            <TextBlock HorizontalAlignment="Center"
                                                                                FontStyle="Italic" FontWeight="Bold"
                                                                                Foreground="Black"
                                                                                Text="{Binding Name}" />
                                                                        </DataTemplate>
                                                                    </GroupStyle.HeaderTemplate>
                                                                </GroupStyle>
                                                            </ListBox.GroupStyle>
                                                            <ListBox.ItemTemplate>
                                                                <DataTemplate>
                                                                    <Border BorderBrush="Black" BorderThickness="2">
                                                                        <Grid>
                                                                            <StackPanel>
                                                                                <TextBlock VerticalAlignment="Center" FontWeight="Bold">
                                                                                    <Run Text="{Binding Item1, Mode=OneTime}" />
                                                                                    <LineBreak />
                                                                                    <Run Text="{Binding Item3, Mode=OneTime, StringFormat=\{0\} Dpi}" />
                                                                                </TextBlock>
                                                                                <CheckBox VerticalAlignment="Center" VerticalContentAlignment="Center"
                                                                                    Content="MOZJPEG" FontWeight="Bold"
                                                                                    IsChecked="{Binding Item4, Mode=OneTime}"
                                                                                    IsHitTestVisible="False" />
                                                                            </StackPanel>
                                                                        </Grid>
                                                                    </Border>
                                                                </DataTemplate>
                                                            </ListBox.ItemTemplate>
                                                        </ListBox>
                                                        <GroupBox>
                                                            <UniformGrid Columns="2">
                                                                <StackPanel>
                                                                    <TextBox VerticalContentAlignment="Center" Text="{Binding Scanner.ProfileName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                                                                    <Button local:Policy.PolicyName="SaveProfile" Command="{Binding SaveProfile}">
                                                                        <StackPanel Orientation="Horizontal">
                                                                            <Image Width="16" Height="16" Source="/TwainControl;component/Icons/save.png" />
                                                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc SAVEPROFILE}" />
                                                                        </StackPanel>
                                                                    </Button>
                                                                </StackPanel>
                                                                <StackPanel>
                                                                    <CheckBox HorizontalContentAlignment="Stretch"
                                                                        Content="{local:Loc LOAD}"
                                                                        IsChecked="{Binding UseSelectedProfile, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}"
                                                                        IsEnabled="{Binding Scanner.SelectedProfile, Converter={StaticResource NullableToBooleanConverter}}" />
                                                                    <ComboBox ItemsSource="{Binding Profile, Source={x:Static properties:Settings.Default}}" SelectedItem="{Binding Scanner.SelectedProfile}">
                                                                        <ComboBox.ItemTemplate>
                                                                            <DataTemplate>
                                                                                <UniformGrid Columns="2">
                                                                                    <TextBlock VerticalAlignment="Center" Text="{Binding Converter={StaticResource SplitConverter}, Mode=OneWay}" />
                                                                                    <Button local:Policy.PolicyName="RemoveProfile" Background="Transparent"
                                                                                        BorderBrush="Transparent"
                                                                                        Command="{Binding DataContext.RemoveProfile, ElementName=UserControl}"
                                                                                        CommandParameter="{Binding Mode=OneWay}"
                                                                                        FontWeight="Bold" Foreground="Red">
                                                                                        <Image Width="16" Height="16" Source="/TwainControl;component/Icons/delete.png" />
                                                                                    </Button>
                                                                                </UniformGrid>
                                                                            </DataTemplate>
                                                                        </ComboBox.ItemTemplate>
                                                                    </ComboBox>
                                                                </StackPanel>
                                                            </UniformGrid>
                                                        </GroupBox>
                                                    </StackPanel>
                                                </Extensions:ContentToggleButton.OverContent>
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Width="16" Height="16">
                                                        <Image.Source>
                                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                                <Binding Source="Shell32.dll" />
                                                                <Binding Source="43" />
                                                            </MultiBinding>
                                                        </Image.Source>
                                                    </Image>
                                                    <TextBlock>
                                                        <TextBlock.Style>
                                                            <Style TargetType="{x:Type TextBlock}">
                                                                <Setter Property="FontWeight" Value="Normal" />
                                                                <Setter Property="Foreground" Value="Black" />
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding UseSelectedProfile, Mode=OneWay, Source={x:Static properties:Settings.Default}}" Value="true">
                                                                        <Setter Property="FontWeight" Value="Bold" />
                                                                        <Setter Property="Foreground" Value="Green" />
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </TextBlock.Style>
                                                        <Run Text="{local:Loc SCAN}" />
                                                        <LineBreak />
                                                        <Run Text="{local:Loc SETTİNGS}" />
                                                    </TextBlock>
                                                </StackPanel>
                                            </Extensions:ContentToggleButton>
                                            <ComboBox Grid.Column="1"
                                                VerticalContentAlignment="Center"
                                                local:Policy.PolicyName="SelectedPaper"
                                                ItemsSource="{Binding Mode=OneWay, Source={StaticResource PaperProfiles}}"
                                                SelectedItem="{Binding SelectedPaper}"
                                                SelectedValue="{Binding SelectedPaper.PaperType}"
                                                SelectedValuePath="PaperType">
                                                <ComboBox.GroupStyle>
                                                    <GroupStyle ContainerStyle="{StaticResource BorderGroupStyleContainerStyle}">
                                                        <GroupStyle.Panel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Columns="4" />
                                                            </ItemsPanelTemplate>
                                                        </GroupStyle.Panel>
                                                        <GroupStyle.HeaderTemplate>
                                                            <DataTemplate>
                                                                <TextBlock HorizontalAlignment="Center"
                                                                    FontStyle="Italic" FontWeight="Bold"
                                                                    Foreground="Black"
                                                                    Text="{Binding Name}" />
                                                            </DataTemplate>
                                                        </GroupStyle.HeaderTemplate>
                                                    </GroupStyle>
                                                </ComboBox.GroupStyle>
                                                <ComboBox.ItemTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition Width="Auto" />
                                                                <ColumnDefinition />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock VerticalAlignment="Center"
                                                                FontStyle="Italic" FontWeight="Bold"
                                                                Text="{Binding PaperType}" />
                                                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                                                <Separator Style="{StaticResource {x:Static ToolBar.SeparatorStyleKey}}" />
                                                            </StackPanel>
                                                            <Viewbox Grid.Column="2">
                                                                <DockPanel LastChildFill="True">
                                                                    <TextBlock HorizontalAlignment="Right"
                                                                        DockPanel.Dock="Top" FontSize="9"
                                                                        Foreground="Red"
                                                                        Text="{Binding Width, StringFormat=\{0\}cm}"
                                                                        TextWrapping="Wrap" />
                                                                    <TextBlock VerticalAlignment="Center"
                                                                        DockPanel.Dock="Left" FontSize="9"
                                                                        Foreground="Red" RenderTransformOrigin="0.5,0.5"
                                                                        SnapsToDevicePixels="True"
                                                                        Text="{Binding Height, StringFormat=\{0\}cm}"
                                                                        TextWrapping="Wrap" UseLayoutRounding="True">
                                                                        <TextBlock.LayoutTransform>
                                                                            <RotateTransform Angle="-90" />
                                                                        </TextBlock.LayoutTransform>
                                                                    </TextBlock>
                                                                    <Rectangle Width="{Binding Width}"
                                                                        Height="{Binding Height}"
                                                                        Stroke="#7F000000" StrokeThickness="2">
                                                                        <Rectangle.Effect>
                                                                            <DropShadowEffect BlurRadius="3" Opacity="0.33" ShadowDepth="3" />
                                                                        </Rectangle.Effect>
                                                                    </Rectangle>
                                                                </DockPanel>
                                                            </Viewbox>
                                                        </Grid>
                                                    </DataTemplate>
                                                </ComboBox.ItemTemplate>
                                            </ComboBox>
                                        </Grid>
                                    </StackPanel>
                                </StackPanel>
                                <Separator />
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition />
                                        <ColumnDefinition />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="30.4" />
                                        <RowDefinition Height="15.2" />
                                        <RowDefinition Height="22.4" />
                                        <RowDefinition Height="16.8" />
                                        <RowDefinition Height="15.2" />
                                    </Grid.RowDefinitions>
                                    <CheckBox VerticalContentAlignment="Center"
                                        BorderBrush="GreenYellow" BorderThickness="2"
                                        IsChecked="{Binding Scanner.Duplex}"
                                        IsEnabled="{Binding Adf, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc TWOSIDE}" />
                                            <CheckBox IsChecked="{Binding Scanner.PaperBackScan}" IsEnabled="{Binding Scanner.Duplex}">
                                                <StackPanel Orientation="Horizontal">
                                                    <TextBlock VerticalAlignment="Center" Text="{local:Loc REVERSE}" />
                                                    <ListBox Width="96" Height="32"
                                                        Background="{x:Null}"
                                                        BorderBrush="{x:Null}"
                                                        IsEnabled="{Binding Scanner.PaperBackScan}"
                                                        SelectedIndex="{Binding BackMode, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                                        <ListBox.ItemContainerStyle>
                                                            <Style BasedOn="{StaticResource ScanTypeLbItem}" TargetType="{x:Type ListBoxItem}">
                                                                <Setter Property="Margin" Value="0" />
                                                            </Style>
                                                        </ListBox.ItemContainerStyle>
                                                        <ListBox.ItemsPanel>
                                                            <ItemsPanelTemplate>
                                                                <UniformGrid Columns="3" />
                                                            </ItemsPanelTemplate>
                                                        </ListBox.ItemsPanel>
                                                        <ListBoxItem>
                                                            <ListBoxItem.Background>
                                                                <VisualBrush Stretch="Fill" Visual="{Binding ElementName=bw}" />
                                                            </ListBoxItem.Background>
                                                        </ListBoxItem>
                                                        <ListBoxItem>
                                                            <ListBoxItem.Background>
                                                                <VisualBrush Stretch="Fill" Visual="{Binding ElementName=grey}" />
                                                            </ListBoxItem.Background>
                                                        </ListBoxItem>
                                                        <ListBoxItem>
                                                            <ListBoxItem.Background>
                                                                <VisualBrush Stretch="Fill" Visual="{Binding ElementName=color}" />
                                                            </ListBoxItem.Background>
                                                        </ListBoxItem>
                                                    </ListBox>
                                                </StackPanel>
                                            </CheckBox>
                                        </StackPanel>
                                    </CheckBox>
                                    <CheckBox Grid.Column="1"
                                        BorderBrush="GreenYellow" BorderThickness="2"
                                        Content="{local:Loc GUI}"
                                        IsChecked="{Binding Scanner.ShowUi}" />
                                    <CheckBox Grid.Row="1" Grid.Column="0"
                                        Content="{local:Loc SHOWFILE}"
                                        IsChecked="{Binding ShowFile, Source={x:Static properties:Settings.Default}}" />
                                    <CheckBox Grid.Row="1" Grid.Column="1"
                                        Content="{local:Loc SHOWPROGRESS}"
                                        IsChecked="{Binding Scanner.ShowProgress}" />
                                    <CheckBox Grid.Row="2" IsChecked="{Binding Scanner.DetectEmptyPage}" IsEnabled="{Binding Adf, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc EMPTYPAGE}" />
                                            <Extensions:NumericUpDownControl Foreground="{StaticResource GroupBoxBackGround}"
                                                IsEnabled="{Binding Scanner.DetectEmptyPage}"
                                                IsReadOnly="True" Maximum="100"
                                                Minimum="1" Orientation="Horizontal"
                                                SmallChange="1"
                                                Value="{Binding EmptyThreshold, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                                <Extensions:NumericUpDownControl.Background>
                                                    <LinearGradientBrush StartPoint="0,0.5" EndPoint="1,0.5">
                                                        <GradientStop Offset="1" Color="Black" />
                                                        <GradientStop Offset="0" Color="White" />
                                                    </LinearGradientBrush>
                                                </Extensions:NumericUpDownControl.Background>
                                            </Extensions:NumericUpDownControl>
                                        </StackPanel>
                                    </CheckBox>
                                    <StackPanel Grid.Row="2" Grid.Column="1" Orientation="Horizontal">
                                        <CheckBox Content="{local:Loc SEPERATOR}" IsChecked="{Binding Scanner.UsePageSeperator}" />
                                        <ComboBox local:Policy.PolicyName="SelectedOrientation"
                                            IsEnabled="{Binding Adf, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}"
                                            ItemsSource="{Binding Mode=OneWay, Source={StaticResource PageOrientation}}"
                                            SelectedItem="{Binding SelectedOrientation}">
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock>
                                                        <Run Text="{Binding Converter={StaticResource EnumOrientationToConvertedLanguageTextConverter}, Mode=OneWay}" />
                                                        <Run FontStyle="Italic" Foreground="Red" Text="{Binding Converter={StaticResource EnumOrientationToTwainVersionConverter}, Mode=OneWay}" />
                                                    </TextBlock>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>
                                    </StackPanel>
                                    <CheckBox Grid.Row="3" IsChecked="{Binding Scanner.ApplyMedian}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc DESPECKLE}" />
                                            <Extensions:NumericUpDownControl Background="{StaticResource Despeckle}"
                                                FontWeight="Bold" Foreground="Magenta"
                                                IsEnabled="{Binding Scanner.ApplyMedian}"
                                                Maximum="10" Minimum="0"
                                                Orientation="Horizontal" SmallChange="1"
                                                Value="{Binding MedianValue, Source={x:Static properties:Settings.Default}}" />
                                        </StackPanel>
                                    </CheckBox>
                                    <CheckBox Grid.Row="3" Grid.Column="1" IsChecked="{Binding AutoCropImage, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}">
                                        <StackPanel IsEnabled="{Binding AutoCropImage, Mode=OneWay, Source={x:Static properties:Settings.Default}}" Orientation="Horizontal">
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc TRIMIMAGE}" />
                                            <Extensions:ContentToggleButton Background="{Binding AutoCropColor, Mode=OneWay, Source={x:Static properties:Settings.Default}}">
                                                <Extensions:ContentToggleButton.OverContent>
                                                    <Extensions:ColorPicker Width="350" Height="250"
                                                        HexCode="{Binding AutoCropColor, Mode=TwoWay, Source={x:Static properties:Settings.Default}, UpdateSourceTrigger=PropertyChanged}"
                                                        PredefinedColorVisibility="Visible" />
                                                </Extensions:ContentToggleButton.OverContent>
                                                <TextBlock d:Text="Black" Text="{Binding AutoCropColor, Mode=OneWay, Source={x:Static properties:Settings.Default}}" />
                                            </Extensions:ContentToggleButton>
                                        </StackPanel>
                                    </CheckBox>
                                    <CheckBox Grid.Row="4" Content="{local:Loc REVERSE}" IsChecked="{Binding Scanner.InvertImage}" />
                                    <CheckBox Grid.Row="4" Grid.Column="1"
                                        Content="{local:Loc FILMSCANNER}"
                                        IsChecked="{Binding Scanner.UseFilmScanner}" />

                                </Grid>
                                <Separator />
                                <Extensions:ButtonedTextBox d:Description="SaveFileName" d:Text="FileName"
                                    BorderBrush="GreenYellow" BorderThickness="2"
                                    Description="{Binding Scanner.SaveFileName}"
                                    GotKeyboardFocus="ButtonedTextBox_GotKeyboardFocus" MaxLength="255"
                                    OpenButtonVisibility="Collapsed"
                                    Text="{Binding Scanner.FileName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged, ValidatesOnDataErrors=True}"
                                    Validation.ErrorTemplate="{StaticResource ValidationErrorTemplate}">
                                    <Extensions:ButtonedTextBox.ContextMenu>
                                        <ContextMenu>
                                            <ContextMenu.Resources>
                                                <Style TargetType="{x:Type MenuItem}">
                                                    <Setter Property="Command" Value="{Binding InsertFileNamePlaceHolder}" />
                                                </Style>
                                            </ContextMenu.Resources>
                                            <MenuItem CommandParameter="[DATE]" Header="{local:Loc DAY}" />
                                            <MenuItem CommandParameter="[MONTH]" Header="{local:Loc MONTH}" />
                                            <MenuItem CommandParameter="[YEAR]" Header="{local:Loc YEAR}" />
                                            <MenuItem CommandParameter="[HOUR]" Header="{local:Loc TIME}" />
                                            <MenuItem CommandParameter="[MINUTE]" Header="{local:Loc MINUTE}" />
                                            <MenuItem CommandParameter="[SECOND]" Header="{local:Loc SECOND}" />
                                            <MenuItem CommandParameter="[GUID]" Header="{local:Loc GUID}" />
                                            <MenuItem CommandParameter="[USERNAME]" Header="{local:Loc USERNAME}" />
                                            <MenuItem CommandParameter="[RESOLUTION]" Header="{local:Loc RES}" />
                                        </ContextMenu>
                                    </Extensions:ButtonedTextBox.ContextMenu>
                                </Extensions:ButtonedTextBox>
                            </StackPanel>
                        </ScrollViewer>
                    </GroupBox>
                </Expander>
                <GroupBox Grid.Row="1">
                    <GroupBox.Header>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition Width="Auto" />
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <Slider AutoToolTipPlacement="TopLeft" Maximum="400"
                                Minimum="85" Orientation="Vertical"
                                SmallChange="1"
                                Style="{StaticResource Slider}"
                                ToolTip="{local:Loc PREVIEWSIZE}"
                                Value="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}" />
                            <Extensions:ContentToggleButton Grid.Column="1">
                                <Extensions:ContentToggleButton.OverContent>
                                    <local:PdfSettings Width="500" />
                                </Extensions:ContentToggleButton.OverContent>
                                <StackPanel Orientation="Horizontal">
                                    <Image Width="24" Height="24">
                                        <Image.Source>
                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                <Binding Source="Shell32.dll" />
                                                <Binding Source="21" />
                                            </MultiBinding>
                                        </Image.Source>
                                    </Image>
                                    <TextBlock VerticalAlignment="Center" Text="{local:Loc SETTİNGS}" />
                                </StackPanel>
                            </Extensions:ContentToggleButton>
                            <ScrollViewer Grid.Column="2"
                                MaxHeight="55"
                                Margin="2,0,2,0"
                                HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
                                <WrapPanel>
                                    <Button local:Policy.PolicyName="ResimSilGeriAl" Command="{Binding ResimSilGeriAl}">
                                        <Image Width="24" Height="24" Source="/TwainControl;component/Icons/undo.png" />
                                    </Button>
                                    <Extensions:ContentToggleButton>
                                        <Extensions:ContentToggleButton.OverContent>
                                            <StackPanel Orientation="Horizontal">
                                                <Button Command="{Binding ListeTemizle}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Width="16" Height="16" Source="/TwainControl;component/Icons/delete.png" />
                                                        <TextBlock VerticalAlignment="Center">
                                                            <Run Text="{local:Loc ALL}" />
                                                            <Run Text="{local:Loc CLEARLIST}" />
                                                        </TextBlock>
                                                    </StackPanel>
                                                </Button>
                                                <Button Command="{Binding SeçiliListeTemizle}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Width="16" Height="16" Source="/TwainControl;component/Icons/delete.png" />
                                                        <TextBlock VerticalAlignment="Center" Text="{local:Loc CLEARLIST}" />
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </Extensions:ContentToggleButton.OverContent>
                                        <Image Width="24" Height="24" Source="/TwainControl;component/Icons/delete.png" />
                                    </Extensions:ContentToggleButton>
                                    <Extensions:SplitButton local:Policy.PolicyName="Tümünüİşaretle" BorderBrush="Cyan" Command="{Binding Tümünüİşaretle}">
                                        <Extensions:SplitButton.InternalContent>
                                            <StackPanel Orientation="Horizontal">
                                                <Button local:Policy.PolicyName="TümününİşaretiniKaldır" Command="{Binding TümününİşaretiniKaldır}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Width="32" Height="32" Source="/TwainControl;component/Icons/none.png" />
                                                        <TextBlock VerticalAlignment="Center" Text="{local:Loc NONE}" />
                                                    </StackPanel>
                                                </Button>
                                                <Button local:Policy.PolicyName="Tersiniİşaretle" Command="{Binding Tersiniİşaretle}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <Image Width="32" Height="32" Source="/TwainControl;component/Icons/inverse.png" />
                                                        <TextBlock VerticalAlignment="Center" Text="{local:Loc REVERSE}" />
                                                    </StackPanel>
                                                </Button>
                                                <Button local:Policy.PolicyName="TümünüİşaretleDikey" Command="{Binding TümünüİşaretleDikey}">
                                                    <Image Width="32" Height="32" Source="/TwainControl;component/Icons/portrait.png" />
                                                </Button>
                                                <Button local:Policy.PolicyName="TümünüİşaretleYatay" Command="{Binding TümünüİşaretleYatay}">
                                                    <Image Width="32" Height="32" Source="/TwainControl;component/Icons/landscape.png" />
                                                </Button>
                                            </StackPanel>
                                        </Extensions:SplitButton.InternalContent>
                                        <StackPanel Orientation="Horizontal">
                                            <Image Width="24" Height="24" Source="/TwainControl;component/Icons/selectall.png" />
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc ALL}" />
                                        </StackPanel>
                                    </Extensions:SplitButton>
                                    <Button local:Policy.PolicyName="SaveFileList" Command="{Binding SaveFileList}">
                                        <Image Width="24" Height="24" Source="/TwainControl;component/Icons/save.png" />
                                    </Button>
                                    <Button local:Policy.PolicyName="LoadFileList" Command="{Binding LoadFileList}">
                                        <Image Width="24" Height="24">
                                            <Image.Source>
                                                <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                    <Binding Source="Shell32.dll" />
                                                    <Binding Source="70" />
                                                </MultiBinding>
                                            </Image.Source>
                                        </Image>
                                    </Button>
                                    <Button local:Policy.PolicyName="CycleSelectedDocuments" Command="{Binding CycleSelectedDocuments}" CommandParameter="{Binding ElementName=Lb}">
                                        <Image Width="24" Height="24">
                                            <Image.Source>
                                                <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                    <Binding Source="Shell32.dll" />
                                                    <Binding Source="55" />
                                                </MultiBinding>
                                            </Image.Source>
                                        </Image>
                                    </Button>
                                </WrapPanel>
                            </ScrollViewer>
                            <StackPanel Grid.Column="3" Orientation="Horizontal">
                                <StackPanel>
                                    <TextBlock HorizontalAlignment="Center" VerticalAlignment="Top" Text="{local:Loc ALL}" />
                                    <Extensions:NumericUpDownControl VerticalAlignment="Center"
                                        BorderBrush="Cyan" LargeChange="1"
                                        Maximum="1" Minimum="-1"
                                        NumericUpdownTextBoxVisibility="Collapsed" Orientation="Horizontal"
                                        SmallChange="1"
                                        Value="{Binding AllImageRotationAngle}" />
                                </StackPanel>
                                <Button local:Policy.PolicyName="InvertSelectedImage" BorderBrush="Cyan"
                                    Command="{Binding InvertSelectedImage}"
                                    Content="[" FontFamily="Wingdings"
                                    FontSize="23" />
                            </StackPanel>
                        </Grid>
                    </GroupBox.Header>
                    <TabControl x:Name="TbCtrl" x:FieldModifier="public" SelectedItem="{Binding SelectedTab}">
                        <TabItem>
                            <TabItem.Header>
                                <StackPanel Orientation="Horizontal">
                                    <Image Width="32" Height="32" VerticalAlignment="Bottom">
                                        <Image.Source>
                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                <Binding Source="Shell32.dll" />
                                                <Binding Source="19" />
                                            </MultiBinding>
                                        </Image.Source>
                                    </Image>
                                    <TextBlock VerticalAlignment="Center" FontWeight="Bold" TextAlignment="Center">
                                        <Run d:Text="0" BaselineAlignment="Center" Text="{Binding Scanner.SeçiliResimSayısı, Mode=OneWay}" />
                                        <Run d:Text="/" BaselineAlignment="Center" Text="/" />
                                        <Run d:Text="0" BaselineAlignment="Center" Text="{Binding Scanner.Resimler.Count, Mode=OneWay}" />
                                        <Hyperlink BaselineAlignment="Center" Command="{Binding ReverseData}" TextDecorations="None">
                                            <Run FontFamily="Wingdings 3" FontSize="16" Text="E" />
                                        </Hyperlink>
                                        <Hyperlink BaselineAlignment="Center" Command="{Binding ReverseDataHorizontal}" TextDecorations="None">
                                            <Run FontFamily="Wingdings 3" FontSize="16" Text="D" />
                                        </Hyperlink>
                                    </TextBlock>
                                </StackPanel>
                            </TabItem.Header>
                            <ListBox x:Name="Lb"
                                Extensions:ScrollDragDrop.ScrollOnDragDrop="True" local:Policy.PolicyName="LoadImage"
                                AllowDrop="True"
                                Background="{StaticResource BorderBackground}"
                                Drop="ListBox_DropAsync"
                                ItemsSource="{Binding Scanner.Resimler, Mode=OneWay}"
                                PreviewMouseWheel="ListBox_PreviewMouseWheel"
                                SelectedIndex="{Binding SeekIndex}"
                                SelectedItem="{Binding SeçiliResim}"
                                SelectionMode="Extended" VirtualizingPanel.CacheLength="3,3"
                                VirtualizingPanel.CacheLengthUnit="Item" VirtualizingPanel.IsVirtualizingWhenGrouping="True"
                                VirtualizingPanel.ScrollUnit="Pixel" VirtualizingPanel.VirtualizationMode="Standard">
                                <ListBox.InputBindings>
                                    <KeyBinding Key="A" Command="{Binding Tümünüİşaretle}" Modifiers="Ctrl" />
                                    <KeyBinding Key="Delete" Command="{Binding SeçiliListeTemizle}" />
                                    <KeyBinding Key="Delete" Command="{Binding ListeTemizle}" Modifiers="Shift" />
                                    <KeyBinding Key="S" Command="{Binding SeçiliKaydet}" Modifiers="Ctrl" />
                                    <KeyBinding Key="S" Command="{Binding SeçiliDirektPdfKaydet}" Modifiers="Ctrl+Shift" />
                                </ListBox.InputBindings>
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="{x:Type ListBoxItem}">
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate>
                                                    <StackPanel Background="{TemplateBinding Background}" Drop="StackPanel_Drop" GiveFeedback="StackPanel_GiveFeedback">
                                                        <TextBlock HorizontalAlignment="Center">
                                                            <InlineUIContainer>
                                                                <Extensions:NumericUpDownControl Height="20"
                                                                    BorderBrush="Cyan" LargeChange="1"
                                                                    Maximum="1" Minimum="-1"
                                                                    NumericUpdownTextBoxVisibility="Collapsed" Orientation="Horizontal"
                                                                    SmallChange="1"
                                                                    Value="{Binding RotationAngle}" />
                                                            </InlineUIContainer><Run AllowDrop="True" Cursor="SizeAll"
                                                                FontFamily="Wingdings" FontSize="24"
                                                                FontWeight="Bold" PreviewMouseMove="Run_PreviewMouseMove"
                                                                Text="B">
                                                                <Run.Style>
                                                                    <Style TargetType="{x:Type Run}">
                                                                        <Setter Property="Foreground" Value="Red" />
                                                                        <Style.Triggers>
                                                                            <DataTrigger Binding="{Binding DragMoveStarted, RelativeSource={RelativeSource AncestorType={x:Type local:TwainCtrl}}}" Value="true">
                                                                                <DataTrigger.EnterActions>
                                                                                    <BeginStoryboard x:Name="Sb">
                                                                                        <Storyboard RepeatBehavior="Forever" Timeline.DesiredFrameRate="12">
                                                                                            <ColorAnimation Storyboard.TargetProperty="(Foreground).(SolidColorBrush.Color)" To="Blue" Duration="0:0:1" />
                                                                                        </Storyboard>
                                                                                    </BeginStoryboard>
                                                                                </DataTrigger.EnterActions>
                                                                            </DataTrigger>
                                                                            <DataTrigger Binding="{Binding DragMoveStarted, RelativeSource={RelativeSource AncestorType={x:Type local:TwainCtrl}}}" Value="false">
                                                                                <DataTrigger.EnterActions>
                                                                                    <StopStoryboard BeginStoryboardName="Sb" />
                                                                                    <RemoveStoryboard BeginStoryboardName="Sb" />
                                                                                </DataTrigger.EnterActions>
                                                                            </DataTrigger>
                                                                        </Style.Triggers>
                                                                    </Style>
                                                                </Run.Style>
                                                            </Run><InlineUIContainer BaselineAlignment="Center">
                                                                <Extensions:ContentToggleButton Background="{x:Null}" BorderBrush="{x:Null}" IsEnabled="{Binding IsSelected, RelativeSource={RelativeSource AncestorType={x:Type ListBoxItem}}}">
                                                                    <Extensions:ContentToggleButton.Style>
                                                                        <Style TargetType="{x:Type Extensions:ContentToggleButton}">
                                                                            <Style.Triggers>
                                                                                <Trigger Property="IsChecked" Value="True">
                                                                                    <Setter Property="OverContent">
                                                                                        <Setter.Value>
                                                                                            <local:SaveDialogUserControl DataContext="{Binding DataContext, Source={x:Reference UserControl}}" />
                                                                                        </Setter.Value>
                                                                                    </Setter>
                                                                                </Trigger>
                                                                                <Trigger Property="IsChecked" Value="False">
                                                                                    <Setter Property="OverContent" Value="{x:Null}" />
                                                                                </Trigger>
                                                                            </Style.Triggers>
                                                                        </Style>
                                                                    </Extensions:ContentToggleButton.Style>
                                                                    <Image Width="24" Height="24" Source="/TwainControl;component/Icons/save.png" />
                                                                </Extensions:ContentToggleButton>
                                                            </InlineUIContainer><Hyperlink local:Policy.PolicyName="InvertImage"
                                                                Command="{Binding DataContext.InvertImage, ElementName=UserControl}"
                                                                CommandParameter="{Binding Mode=OneWay}"
                                                                TextDecorations="None">
                                                                <Run FontFamily="Wingdings" FontSize="26"
                                                                    Foreground="Black" Text="[" />
                                                            </Hyperlink><Hyperlink local:Policy.PolicyName="AutoDeskewImage"
                                                                Command="{Binding DataContext.AutoDeskewImage, ElementName=UserControl}"
                                                                CommandParameter="{Binding Mode=OneWay}"
                                                                TextDecorations="None">
                                                                <Run FontFamily="Wingdings 3" FontSize="26"
                                                                    Foreground="Black" Text="R" />
                                                            </Hyperlink><Hyperlink local:Policy.PolicyName="ResimSil" BaselineAlignment="Center"
                                                                Command="{Binding DataContext.ResimSil, ElementName=UserControl}"
                                                                CommandParameter="{Binding Mode=OneWay}"
                                                                FontFamily="Segoe UI Black" TextDecorations="None">
                                                                <InlineUIContainer>
                                                                    <Image Width="24" Height="24" Source="/TwainControl;component/Icons/delete.png" />
                                                                </InlineUIContainer>
                                                            </Hyperlink>
                                                        </TextBlock>
                                                        <Canvas Width="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}" Height="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}">
                                                            <ToggleButton Width="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}"
                                                                Height="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}"
                                                                VerticalAlignment="Center" VerticalContentAlignment="Center"
                                                                Background="{x:Null}"
                                                                BorderBrush="{x:Null}"
                                                                IsChecked="{Binding Seçili}"
                                                                RenderTransformOrigin="0.5,0.5"
                                                                Style="{StaticResource ToggleButtonAnimationStyle}">
                                                                <ToggleButton.RenderTransform>
                                                                    <TransformGroup>
                                                                        <ScaleTransform />
                                                                        <SkewTransform />
                                                                        <RotateTransform />
                                                                        <TranslateTransform />
                                                                    </TransformGroup>
                                                                </ToggleButton.RenderTransform>
                                                                <Viewbox>
                                                                    <Image Width="{Binding ResimThumb.Width, Mode=OneWay}"
                                                                        Height="{Binding ResimThumb.Height, Mode=OneWay}"
                                                                        d:Height="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}"
                                                                        d:Source="/GpScanner;component/scanner.ico"
                                                                        d:Width="{Binding PreviewWidth, Source={x:Static properties:Settings.Default}}">
                                                                        <Image.Source>
                                                                            <PriorityBinding>
                                                                                <Binding IsAsync="True" Mode="OneWay" Path="ResimThumb" />
                                                                                <Binding Converter="{StaticResource FilePathToIconConverter}" Path="FilePath" />
                                                                            </PriorityBinding>
                                                                        </Image.Source>
                                                                    </Image>
                                                                </Viewbox>
                                                            </ToggleButton>
                                                            <TextBlock Canvas.Left="0" Canvas.Bottom="0"
                                                                FontWeight="Bold"
                                                                Text="{Binding Index, Mode=OneWay}" />
                                                        </Canvas>
                                                    </StackPanel>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Seçili}" Value="true">
                                                <Setter Property="Background" Value="MediumSeaGreen" />
                                                <Setter Property="IsSelected" Value="True" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <Extensions:VirtualizingWrapPanel CanHorizontallyScroll="False" SpacingMode="None" />
                                    </ItemsPanelTemplate>
                                </ListBox.ItemsPanel>
                            </ListBox>
                        </TabItem>
                        <TabItem>
                            <TabItem.Header>
                                <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.pdf}" />
                            </TabItem.Header>
                            <local:PdfImportViewerControl x:Name="PdfImportViewer" x:FieldModifier="public" />
                        </TabItem>
                        <TabItem>
                            <TabItem.Header>
                                <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.udf}" />
                            </TabItem.Header>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <Controls:XpsViewer x:Name="xpsViewer" x:FieldModifier="public" />
                                <UniformGrid Grid.Row="1" Columns="2">
                                    <Button local:Policy.PolicyName="LoadSingleUdfFile" Command="{Binding LoadSingleUdfFile}" CommandParameter="{Binding ElementName=xpsViewer}">
                                        <StackPanel Orientation="Horizontal">
                                            <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.udf}" />
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc FILE}" />
                                        </StackPanel>
                                    </Button>
                                    <TextBlock Text="{local:Loc LIMITED}" TextWrapping="Wrap" />
                                </UniformGrid>
                            </Grid>
                        </TabItem>
                        <TabItem>
                            <TabItem.Header>
                                <Image Width="32" Height="32">
                                    <Image.Source>
                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                            <Binding Source="Shell32.dll" />
                                            <Binding Source="96" />
                                        </MultiBinding>
                                    </Image.Source>
                                </Image>
                            </TabItem.Header>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>
                                <ListBox x:Name="LbEypContent"
                                    Extensions:ScrollDragDrop.ScrollOnDragDrop="True"
                                    d:ItemsSource="{d:SampleData ItemCount=5}"
                                    local:Policy.PolicyName="EypPdfDosyaEkle" AllowDrop="True"
                                    Background="{StaticResource BorderBackground}"
                                    Drop="LbEypContent_Drop"
                                    ItemsSource="{Binding Scanner.UnsupportedFiles}"
                                    VirtualizingPanel.CacheLength="2,2" VirtualizingPanel.CacheLengthUnit="Item"
                                    VirtualizingPanel.IsVirtualizingWhenGrouping="True" VirtualizingPanel.ScrollUnit="Pixel"
                                    VirtualizingPanel.VirtualizationMode="Standard">
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="{x:Type ListBoxItem}">
                                            <Setter Property="Template">
                                                <Setter.Value>
                                                    <ControlTemplate>
                                                        <StackPanel Drop="StackPanel_EypDrop" Orientation="Horizontal">
                                                            <TextBlock VerticalAlignment="Center">
                                                                <Run AllowDrop="True" BaselineAlignment="Center"
                                                                    Cursor="SizeAll" FontFamily="Wingdings"
                                                                    FontSize="24" FontWeight="Bold"
                                                                    Foreground="Red" PreviewMouseMove="Run_EypPreviewMouseMove"
                                                                    Text="B" />
                                                            </TextBlock>
                                                            <ContentPresenter d:ContentTemplate="{StaticResource XmlViewerTemplate}"
                                                                d:ContentTemplateSelector="{StaticResource PdfEypViewerSelector}"
                                                                d:Height="315" d:Width="315"
                                                                Content="{Binding IsAsync=True, Mode=OneWay}"
                                                                ContentTemplateSelector="{StaticResource PdfEypViewerSelector}" />
                                                        </StackPanel>
                                                    </ControlTemplate>
                                                </Setter.Value>
                                            </Setter>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                    <ListBox.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <Extensions:VirtualizingWrapPanel CanHorizontallyScroll="False" ItemSize="315,315" SpacingMode="None" />
                                        </ItemsPanelTemplate>
                                    </ListBox.ItemsPanel>
                                </ListBox>
                                <UniformGrid Grid.Row="1" Columns="2">
                                    <Button local:Policy.PolicyName="EypPdfDosyaEkle" Command="{Binding EypPdfDosyaEkle}">
                                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                            <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.pdf}" />
                                            <TextBlock VerticalAlignment="Center" Text="{local:Loc FILE}" />
                                        </StackPanel>
                                    </Button>
                                    <Button HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                                        local:Policy.PolicyName="EypPdfİçerikBirleştir"
                                        Command="{Binding EypPdfİçerikBirleştir}">
                                        <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                            <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.pdf}" />
                                            <TextBlock VerticalAlignment="Center">
                                                <Run Text="{local:Loc ALL}" />
                                                <Run Text="{local:Loc MERGE}" />
                                            </TextBlock>
                                        </StackPanel>
                                    </Button>
                                </UniformGrid>
                            </Grid>
                        </TabItem>
                        <TabItem>
                            <TabItem.Header>
                                <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.zip}" />
                            </TabItem.Header>
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Button Command="{Binding LoadArchiveFile}" CommandParameter="{Binding ElementName=ArchiveVwr, Mode=OneWay}">
                                    <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                        <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.zip}" />
                                        <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc FILE}" />
                                    </StackPanel>
                                </Button>
                                <local:SimpleArchiveViewer x:Name="ArchiveVwr" Grid.Row="1" />
                            </Grid>
                        </TabItem>
                    </TabControl>
                </GroupBox>
                <UniformGrid Grid.Row="2" Columns="2" Rows="2">
                    <Button HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                        local:Policy.PolicyName="LoadImage" BorderBrush="GreenYellow"
                        BorderThickness="2"
                        Command="{Binding LoadImage}">
                        <Grid>
                            <ProgressBar Background="{x:Null}"
                                BorderBrush="{x:Null}"
                                Maximum="1"
                                Value="{Binding PdfLoadProgressValue}" />
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <Image Width="32" Height="32">
                                    <Image.Source>
                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                            <Binding Source="Shell32.dll" />
                                            <Binding Source="139" />
                                        </MultiBinding>
                                    </Image.Source>
                                </Image>
                                <Image Width="32" Height="32" Source="{Binding Converter={StaticResource FilePathToIconConverter}, Source=.pdf}" />
                                <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc FILE}" />
                            </StackPanel>
                        </Grid>
                    </Button>
                    <Button HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                        local:Policy.PolicyName="SeçiliKaydet"
                        Command="{Binding SeçiliKaydet}">
                        <Grid>
                            <ProgressBar d:Foreground="#FF06B025"
                                Background="{x:Null}"
                                BorderBrush="{x:Null}"
                                Foreground="{Binding Scanner.SaveProgressBarForegroundBrush}"
                                IsIndeterminate="{Binding Scanner.SaveProgressIndeterminate}"
                                Maximum="1"
                                Value="{Binding Scanner.PdfSaveProgressValue}" />
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <Canvas Width="32" Height="32">
                                    <Image Width="32" Height="32" Source="/TwainControl;component/Icons/save.png" />
                                    <TextBlock d:Text="0" FontSize="11"
                                        FontWeight="Bold" Foreground="Red"
                                        Text="{Binding Scanner.SeçiliResimSayısı}" />
                                </Canvas>
                                <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc SAVESELECTED}" />
                            </StackPanel>
                        </Grid>
                    </Button>
                    <Button HorizontalContentAlignment="Stretch" VerticalContentAlignment="Stretch"
                        local:Policy.PolicyName="SeçiliDirektPdfKaydet" BorderBrush="GreenYellow"
                        BorderThickness="2"
                        Command="{Binding SeçiliDirektPdfKaydet}">
                        <Grid>
                            <ProgressBar d:Foreground="#FF06B025"
                                Background="{x:Null}"
                                BorderBrush="{x:Null}"
                                Foreground="{Binding Scanner.SaveProgressBarForegroundBrush}"
                                Maximum="1"
                                Value="{Binding Scanner.PdfSaveProgressValue}" />
                            <StackPanel HorizontalAlignment="Center" Orientation="Horizontal">
                                <Canvas Width="32" Height="32">
                                    <Image Width="32" Height="32">
                                        <Image.Source>
                                            <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                                <Binding Source="Shell32.dll" />
                                                <Binding Source="223" />
                                            </MultiBinding>
                                        </Image.Source>
                                    </Image>
                                    <TextBlock d:Text="0" FontSize="11"
                                        FontWeight="Bold" Foreground="Red"
                                        Text="{Binding Scanner.SeçiliResimSayısı}" />
                                </Canvas>
                                <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc AUTOPATH}">
                                    <TextBlock.Style>
                                        <Style TargetType="{x:Type TextBlock}">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Mode, Mode=OneWay, Source={x:Static properties:Settings.Default}}" Value="0">
                                                    <Setter Property="Foreground" Value="Black" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding Mode, Mode=OneWay, Source={x:Static properties:Settings.Default}}" Value="2">
                                                    <Setter Property="Foreground" Value="{StaticResource Colorfull}" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </Button>
                    <Extensions:SplitButton Command="{Binding WebAdreseGit}" CommandParameter="https://github.com/goksenpasli">
                        <Extensions:SplitButton.InternalContent>
                            <local:AboutView />
                        </Extensions:SplitButton.InternalContent>
                        <StackPanel Orientation="Horizontal">
                            <Image Width="32" Height="32">
                                <Image.Source>
                                    <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                        <Binding Source="Shell32.dll" />
                                        <Binding Source="14" />
                                    </MultiBinding>
                                </Image.Source>
                            </Image>
                            <TextBlock VerticalAlignment="Center" FontWeight="Bold" Text="{local:Loc ABOUT}" />
                        </StackPanel>
                    </Extensions:SplitButton>
                </UniformGrid>
            </Grid>
        </GroupBox>
        <GridSplitter Grid.Column="1"
            Width="3"
            HorizontalAlignment="Stretch"
            Background="{StaticResource GroupBoxBackGround}"
            MouseDoubleClick="GridSplitter_MouseDoubleClick" MouseRightButtonDown="GridSplitter_MouseRightButtonDown"
            ToolTip="{local:Loc SPLITTERTOOLTIP}" />
        <TabControl Grid.Column="2">
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Image Width="16" Height="16">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                    <Binding Source="Shell32.dll" />
                                    <Binding Source="1" />
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <TextBlock VerticalAlignment="Center" Text="{local:Loc DOCUMENT}" />
                    </StackPanel>
                </TabItem.Header>
                <GroupBox Panel.ZIndex="-1" Background="{StaticResource GroupBoxBackGround}">
                    <GroupBox.Header>
                        <StackPanel Orientation="Horizontal">
                            <Button local:Policy.PolicyName="AddActiveVisibleContentImage" Command="{Binding AddActiveVisibleContentImage}">
                                <Image Width="16" Height="16">
                                    <Image.Source>
                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                            <Binding Source="Shell32.dll" />
                                            <Binding Source="245" />
                                        </MultiBinding>
                                    </Image.Source>
                                </Image>
                            </Button>
                            <Button local:Policy.PolicyName="InsertClipBoardImage" BorderBrush="Cyan" Command="{Binding InsertClipBoardImage}">
                                <Image Width="16" Height="16">
                                    <Image.Source>
                                        <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                            <Binding Source="Shell32.dll" />
                                            <Binding Source="260" />
                                        </MultiBinding>
                                    </Image.Source>
                                </Image>
                            </Button>
                            <Extensions:NumericUpDownControl IsEnabled="{Binding SeçiliResim, Converter={StaticResource NullableToBooleanConverter}}"
                                IsReadOnly="True"
                                Maximum="{Binding Scanner.Resimler.Count, Mode=OneWay}"
                                Minimum="0" NumericUpdownTextBoxVisibility="Collapsed"
                                Orientation="Horizontal" SmallChange="1"
                                Value="{Binding SeekIndex}" />
                            <TextBlock VerticalAlignment="Center" Text="{Binding SeekIndex, Mode=OneWay, Converter={StaticResource PageNumberOneUpConverter}}" />
                        </StackPanel>
                    </GroupBox.Header>
                    <Grid>
                        <DockPanel IsEnabled="{Binding SeçiliResim, Converter={StaticResource NullableToBooleanConverter}}">
                            <Slider Margin="20,0,20,0"
                                DockPanel.Dock="Top" IsSnapToTickEnabled="True"
                                Maximum="{Binding SeçiliResim.Resim.PixelWidth}"
                                Style="{StaticResource SliderStyle}"
                                TickPlacement="BottomRight"
                                Value="{Binding Scanner.CropLeft}" />
                            <Slider Margin="25,0,20,0"
                                DockPanel.Dock="Bottom" IsDirectionReversed="True"
                                IsSnapToTickEnabled="True"
                                Maximum="{Binding SeçiliResim.Resim.PixelWidth}"
                                Style="{StaticResource SliderStyle}"
                                TickPlacement="TopLeft"
                                Value="{Binding Scanner.CropRight}" />
                            <Slider Margin="0,-5,0,20"
                                DockPanel.Dock="Left" IsDirectionReversed="True"
                                IsSnapToTickEnabled="True"
                                Maximum="{Binding SeçiliResim.Resim.PixelHeight}"
                                Orientation="Vertical"
                                Style="{StaticResource SliderStyle}"
                                TickPlacement="BottomRight"
                                Value="{Binding Scanner.CropTop}" />
                            <Slider Margin="0,0,0,20"
                                DockPanel.Dock="Right" IsSnapToTickEnabled="True"
                                Maximum="{Binding SeçiliResim.Resim.PixelHeight}"
                                Orientation="Vertical"
                                Style="{StaticResource SliderStyle}"
                                TickPlacement="TopLeft"
                                Value="{Binding Scanner.CropBottom}" />
                            <Grid Panel.ZIndex="-1">
                                <Extensions:ImageViewer x:Name="ImgViewer"
                                    d:Source="/GpScanner;component/splash.png" d:Zoom="1"
                                    Angle="{Binding Scanner.RotateAngle, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                    OpenButtonVisibility="Collapsed" PanoramaButtonVisibility="Collapsed"
                                    PreviewMouseDown="ImgViewer_MouseDown" PreviewMouseMove="ImgViewer_MouseMoveAsync"
                                    PreviewMouseWheel="ImgViewer_PreviewMouseWheel" PrintButtonVisibility="Visible"
                                    SnapTick="True"
                                    Source="{Binding SeçiliResim.Resim, Mode=OneWay}" />
                                <Canvas x:Name="cnv" />
                            </Grid>
                        </DockPanel>
                        <Expander HorizontalAlignment="Left" VerticalAlignment="Bottom"
                            ExpandDirection="Up"
                            IsExpanded="{Binding Scanner.CropDialogExpanded}">
                            <Grid>
                                <local:ToolBox />
                                <ToggleButton HorizontalAlignment="Right" VerticalAlignment="Top"
                                    Background="{x:Null}"
                                    BorderBrush="{x:Null}"
                                    IsChecked="{Binding Scanner.CropDialogExpanded}">
                                    <Image Width="16" Height="16" Source="/TwainControl;component/Icons/delete.png" />
                                </ToggleButton>
                            </Grid>
                        </Expander>
                    </Grid>
                </GroupBox>
            </TabItem>
            <TabItem>
                <TabItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <Image Width="16" Height="16">
                            <Image.Source>
                                <MultiBinding Converter="{StaticResource SystemFileIconConverter}">
                                    <Binding Source="pifmgr.dll" />
                                    <Binding Source="16" />
                                </MultiBinding>
                            </Image.Source>
                        </Image>
                        <TextBlock VerticalAlignment="Center" Text="{local:Loc GRAPH}" />
                    </StackPanel>
                </TabItem.Header>
                <GroupBox Header="{local:Loc GRAPH}">
                    <local:DrawControl EditingImage="{Binding SeçiliResim.Resim}" />
                </GroupBox>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>